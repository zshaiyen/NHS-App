{% extends "base.html" %}
{% block content %}
<div class="dashboard p-4">
  <h2>Dashboard</h2>
  <div class="box-container">
    <div class="boxtotal" onclick="window.location='{{ url_for('viewlogs') }}';">
      <h3>TOTAL HOURS</h3>
      <p>{{ '%0.1f' % total_hours_worked | float }} / {{ '%0.1f' % total_hours_required | float }}</p>
    </div>
  </div>
  <div class="box-container">
  {% for user_category in user_categories %}
    {% if user_category['hours_worked'] < user_category['hours_required'] %}
      {% if user_category['informational_only_flag']|int == 1 %}
      <div class="boxbad">
      {% else %}
      <div class="boxbad" onclick="window.location='{{ url_for('loghours') }}?defaultcategory={{ user_category['category_name'] }}';">
      {% endif %}
    {% else %}
      {% if user_category['informational_only_flag']|int == 1 %}
      <div class="boxgood">
      {% else %}
      <div class="boxgood" onclick="window.location='{{ url_for('loghours') }}?defaultcategory={{ user_category['category_name'] }}';">
      {% endif %}
    {% endif %}
      <h3>{{ user_category['category_name'] }}</h3>
      <p>{{ '%0.1f' % user_category['hours_worked'] | float }} / {{ '%0.1f' % user_category['hours_required'] | float }}</p>
    </div>
  {% endfor %}
  </div>
</div>

<div class="container">
  <h3>Last 3 Verification Logs</h3>

  <table class="table table-striped">
    <tr class="table-primary">
      <th><span class="small">Category</span><br>Event Name</th>
      <th><span class="small">Period</span><br>Event Date</th>
      <th>Hours</th>
      <th>Signature<br><span class="small">Location</span></th>
    </tr>
    {% for log in logs %}
    <tr class="align-middle">
      <td><span class="small text-muted">{{ log['category_name'] }}</span><br><a href="{{ url_for('loghours') }}/{{ log['verification_log_id'] }}">{{ log['event_name'] }}</a></td>
      <td><span class="small text-muted">{{ log['period_name'] }}</span><br>{{ log['event_date'] }}</td>
      <td><span class="fs-2 text-center align-middle">{{ '%0.1f' % log['hours_worked'] | float }}</span></td>
      <td>
        {% if log['supervisor_signature'] %}
        <svg xmlns="http://www.w3.org/2000/svg" width="100" height="35" viewBox="0 0 400 140">
        <path stroke="navy" stroke-width="2" fill="none" d="{{ log['supervisor_signature'] }}" />
        </svg>
        {% else %}
        <span class="badge bg-danger">No Signature</span>
        {% endif %}
  
        <p>
        {% if log['location_coords'] %}
        <a href="https://maps.google.com/?q={{ log['location_coords'] }}" target=_blank>
            {% if log['location_accuracy'] and log['location_accuracy']|int <= 25 %}
            <span class="badge bg-info">High Accuracy</span>
            {% elif log['location_accuracy']|int > 25 and log['location_accuracy']|int <= 100 %}
            <span class="badge bg-warning">Medium Accuracy</span>
            {% elif log['location_accuracy']|int > 100 %}
            <span class="badge bg-warning">Low Accuracy</span>
            {% endif %}
        </a>
        {% else %}
            <span class="badge bg-danger">No Location</span>
        {% endif %}
        </p>
  
      </td>
    </tr>
    {% endfor %}
  </table>  
</div>

<style>
.dashboard {
  padding: 20px;
}

.box-container {
  display: flex;
  justify-content: space-around;
  margin-top: 20px;
}

.box {
  background-color: #f9f9f9;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
  width: 22%;
  text-align: center;
}

.boxgood {
  background-color: #acd8a7;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
  width: 22%;
  text-align: center;
}

.boxgood p {
  font-size: 24px;
  margin: 10px;
}

.boxgood h3 {
  margin-top: 0;
}

.boxbad {
  background-color: #f69697;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
  width: 22%;
  text-align: center;
}

.boxbad p {
  font-size: 24px;
  margin: 10px;
}

.boxbad h3 {
  margin-top: 0;
}

.boxtotal {
  background-color: #f9f9f9;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
  width: 100%;
  text-align: center;
}

.boxtotal p {
  font-size: 24px;
  margin: 10px;
}

.boxtotal h3 {
  margin-top: 0;
}

.box h3 {
  margin-top: 0;
}

.box p {
  font-size: 24px;
  margin: 10px;
}

table {
  border-collapse: collapse;
  width: 100%;
  margin-top: 20px;
}

table, th, td {
  border: 1px solid black;
}

th, td {
  padding: 12px;
  text-align: left;
}

th {
  background-color: #f2f2f2;
}

.container {
  padding: 20px;
}

</style>
{% endblock %}
